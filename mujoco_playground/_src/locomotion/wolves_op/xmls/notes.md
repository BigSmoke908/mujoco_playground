# Erklärung der MuJoCo-XML (Modell: „wolfgang feet only“)

> Ziel: Alle zentralen Elemente und Fachbegriffe verständlich erklären. Wiederkehrende Muster (z. B. viele `geom`-Zeilen) werden einmal allgemein beschrieben, damit das Dokument lesbar bleibt.

| Code / Abschnitt                                                                                           | Bedeutung                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ---------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `<mujoco model="wolfgang feet only">`                                                                      | Beginn der MuJoCo-Modellbeschreibung; `model` ist der Modellname.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| `<compiler angle="radian" />`                                                                              | Parser-/Einheitenvorgaben. `angle="radian"` bedeutet: alle Winkel werden in **Radiant** angegeben (nicht in Grad).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| `<option iterations="3" ls_iterations="5" timestep="0.002" integrator="Euler">`                            | Globale Simulationsoptionen. <br>• `iterations`: Anzahl der Lösungs-Iterationen pro Schritt für die **Nebenbedingungen** (z. B. Kontakte). Mehr = genauer, aber langsamer. <br>• `ls_iterations`: **Line-Search**-Feinabstufungen innerhalb der Lösung (kleine Schrittweiten zur Stabilisierung). <br>• `timestep="0.002"`: Zeitschritt in Sekunden → 1/0.002 = 500 Hz. Kleiner = genauer/langsamer; größer = grober/schneller. <br>• `integrator="Euler"`: Numerisches **Integrationsverfahren** (expliziter Euler). Integriert aus Kräften/Beschleunigungen neue Geschwindigkeiten/Positionen.                                                                                                                                                                                                         |
| `<flag eulerdamp="disable"/>`                                                                              | Schaltet die optionale Euler-Dämpfung aus. Diese künstliche Dämpfung kann numerisches Zittern reduzieren; hier bewusst deaktiviert.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| `<default> … </default>`                                                                                   | Sammelstelle für **Voreinstellungen** (Klassen), die später geerbt werden. Spart Wiederholungen.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| `<default class="humanoid">`                                                                               | **Basis-Klasse** für Körperteile/Geometrien/Sites des Humanoiden. Alles innerhalb erbt von hier, sofern `childclass="humanoid"` gesetzt ist oder untergeordnete Elemente in dieser Klasse liegen.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| `<default class="collision">` + `<geom group="3" contype="1" conaffinity="1" />`                           | Kollisions-Klasse: Standardwerte für **Kollisionsgeometrien**. <br>• `group`: Sicht-/Filtergruppe im Viewer. <br>• `contype` und `conaffinity`: bestimmen, ob/womit ein Objekt Kontakt erzeugt (Bitmasken).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `<default class="visual">` + `<geom material="black" contype="0" conaffinity="0" group="2" />`             | Visual-Klasse: **nur Sichtbarkeit**, keine Kollision. Nutzt Material `black`, keine Kontakte (`contype=0`, `conaffinity=0`).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| `<default class="mx106"> …` / `<default class="mx64"> …` / `<default class="xh-540"> …`                    | Motor-/Gelenk-**Typklassen** (benannt nach Servo-Serien). Legen Standardparameter für Joints/Aktuatoren fest: <br>• `joint damping`: viskose **Dämpfung** (Kraft ∝ Winkelgeschwindigkeit); stabilisiert Bewegung. <br>• `armature`: äquivalente rotierende **Trägheit** im Gelenk (numerische Stabilisierung, „Motorträgheit“). <br>• `frictionloss`: Coulomb-/viskoses Reibmoment im Gelenk. <br>• `<position kp="…">`: Positions-**Stellglied** mit Proportionalverstärkung `kp` (Reglerhärte). <br>• `ctrlrange`: erlaubter Steuerbereich (z. B. gewünschter Winkel). <br>• `forcerange`: Begrenzung der vom Aktuator aufbringbaren Kraft/Drehmoment.                                                                                                                                                 |
| `<site size="0.01" rgba="1 0 0 1" group="4"/>` (in `default humanoid`)                                     | Standard für **Sites** (Mess-/Referenzpunkte): Darstellungsgröße/Farbe/Gruppe. Sites werden von Sensoren referenziert.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `<asset><material name="black" rgba="0.2 0.2 0.2 1"/></asset>`                                             | Materialdefinitionen. `rgba` = Farbe (Rot, Grün, Blau, Alpha/Deckkraft).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| `<worldbody>`                                                                                              | Start der **Szene** (Welt). Enthält alle Körper (`<body>`), Lichter (`<light>`), Kameras (`<camera>`).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `<light name="spotlight" mode="targetbodycom" target="torso" pos="3 0 4"/>`                                | Lichtquelle. <br>• `mode="targetbodycom"`: richtet sich zum **Schwerpunkt** (Center of Mass) des `target`-Körpers aus. <br>• `pos`: Position des Lichts.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| `<body name="torso" pos="0 0 0.4274" quat="0.999 0.0 0.05 0.0" childclass="humanoid">`                     | Hauptkörper **Torso**. <br>• `pos`: Startposition (Meter). <br>• `quat`: **Quaternion** für Orientierung (w, x, y, z). Quaternions vermeiden Gimbal-Lock; normiert. <br>• `childclass="humanoid"`: Kinder erben Voreinstellungen aus Klasse `humanoid`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `<freejoint/>`                                                                                             | 6-DoF-Gelenk (3 Translationen + 3 Rotationen) am Torso → der gesamte Körper ist **frei beweglich** im Raum.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `<site name="imu"/>`                                                                                       | Markierter Punkt für die IMU (Inertial-Messeinheit). Wird von Sensoren (`gyro`, `accelerometer`, etc.) referenziert.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `<camera … mode="trackcom"/>`                                                                              | Kamera, die dem Schwerpunkt des Modells automatisch folgt. `pos` = Kamerastandpunkt; `xyaxes` = Ausrichtung; `fovy` (falls vorhanden) = vertikales Sichtfeld in Grad.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `<inertial … mass="…" diaginertia="…"/>`                                                                   | **Trägheitseigenschaften** eines Körpers: <br>• `mass` in kg. <br>• `diaginertia`: Hauptträgheitsmomente um lokale x/y/z-Achsen (Widerstand gegen Winkelbeschleunigung). <br>• `pos`, `quat` geben Schwerpunktlage/-orientierung relativ zum Body-Ursprung an.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| `<geom … type="box"/"cylinder" class="visual"                                                              | "collision">`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | **Geometrie** eines Körpers. <br>• `type`: Form (Box, Zylinder, …). <br>• `size`: Halb-Ausdehnungen (Box) bzw. Radius/Höhe (Zylinder). <br>• `pos`, `quat`: lokale Lage/Ausrichtung im Körper. <br>• `class="visual"` = nur sichtbar; `class="collision"` = kollidierend. <br>Viele Zeilen modellieren das sichtbare Mesh des Torsos, Schultern, Arme, Beine, Füße. Physikalisch relevant sind v. a. die Kollisionsgeometrien (z. B. `l_foot1`, `r_foot1`). |
| (Arm-Bodies `r_shoulder`, `r_upper_arm`, `r_lower_arm`, `l_shoulder`, …)`                                  | Sichtgeometrien und Trägheiten für Arme/Schultern. In diesem Modell dienen sie primär der Darstellung; Fuß-/Bein-Kinematik ist für „feet only“ entscheidend.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **Bein-Kinematik rechts** (`r_hip_1` → `r_hip_2` → `r_upper_leg` → `r_lower_leg` → `r_ankle` → `r_foot_l`) | Hierarchische **Körperkette** (Parent→Child). Jeder Abschnitt besitzt ein Gelenk: <br>• `r_hip_1` mit `joint name="LR_HR" axis="0 1 0"` = **Hip Roll** (Rollrotation, seitliches Kippen). <br>• `r_hip_2` mit `LR_HAA` `axis="0 0 -1"` = **Hip Ab-/Adduktion** (seitliches Ausschwenken). <br>• `r_upper_leg` mit `LR_HFE` `axis="0 1 0"` = **Hip Flex/Ext** (Beugen/Strecken in Sagittalebene). <br>• `r_lower_leg` mit `LR_KFE` `axis="0 -1 0"` = **Knee Flex/Ext** (Knie beugen/strecken). <br>• `r_ankle` mit `LR_FFE` `axis="0 0 -1"` = **Foot Flex/Ext** (Knöchel dors./plantar). <br>• `r_foot_l` mit `LR_FAA` `axis="0 -1 0"` = **Foot Ab-/Adduktion** (Kippung nach medial/lateral). <br>**Hinweis zu Namenspräfixen:** `LR_…` = „Leg Right“ (rechtes Bein), `LL_…` = „Leg Left“ (linkes Bein). |
| **Bein-Kinematik links** (`l_hip_1` … `l_foot_l`)                                                          | Spiegelbildlich zur rechten Seite mit Namen `LL_HR`, `LL_HAA`, `LL_HFE`, `LL_KFE`, `LL_FFE`, `LL_FAA`. Die `range`-Vorzeichen können gespiegelt sein (z. B. `ref`-Offsets an Kniegelenken), damit die **Neutralstellung** beider Beine konsistent ist.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `joint … range="a b"`                                                                                      | Erlaubter **Winkelbereich** (in Radiant) des Gelenks. Beispiel `-1.5708 1.5708` ≈ ±90°. Übergriffe werden durch harte Limits/Soft-Constraints verhindert.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| `joint … axis="x y z"`                                                                                     | **Drehachse** im lokalen Gelenkkoordinatensystem. Nur bei 1-DoF-Revolute-Joints relevant.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| `joint … class="mx106"/"xh-540"`                                                                           | Verknüpft Joint mit Default-**Gelenk-/Aktuatorparametern** (Dämpfung, Armature, Reibung, Aktuator-`kp`, Kraftgrenzen).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `joint … ref="…" `                                                                                         | **Referenzwinkel** (Versatz), z. B. `ref="0.15"` am Knie: verschiebt die Nullstellung für Regler/Sensorik, damit die mechanische Neutralposition sinnvoll getroffen wird.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| `quat="…"` an Bodies/Geoms                                                                                 | **Quaternion** (w x y z). Dreht den lokalen Frame des Elements relativ zum Parent. Viele kurze Quaternions (0.7071 …) stehen für 90°-Drehungen.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| `<body name="neck"> … <body name="head"> …`                                                                | Kopf-/Halskörper mit Sichtgeometrie und Trägheiten; in diesem Modell ohne eigene steuernde Gelenke (dient Darstellung/Massenverteilung).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| `<actuator> … </actuator>`                                                                                 | **Aktuatoren-Zuordnung** zu Joints. Je `<position joint="…" name="…" class="…"/>` erzeugt einen **Positionsregler** pro Gelenk. <br>• Die **Kennwerte** (z. B. `kp`, `ctrlrange`, `forcerange`) kommen aus der zugewiesenen Default-Klasse (`mx106`, `xh-540`, …). <br>• Bedeutung: Aktuator erhält als **Steuereingang** eine Soll-Position (innerhalb `ctrlrange`) und erzeugt daraus ein Drehmoment, begrenzt durch `forcerange`.                                                                                                                                                                                                                                                                                                                                                                     |
| `<sensor>`-Block                                                                                           | Definition der **Sensorik** (meist am `site="imu"` bzw. an Fuß-Sites).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `<gyro site="imu" name="gyro"/>`                                                                           | **Gyroskop**: misst Winkelgeschwindigkeit (rad/s) des Frames am Site `imu`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `<accelerometer site="imu" …/>`                                                                            | **Beschleunigungssensor**: misst lineare Beschleunigung (inkl. Gravitation, je nach Frame-Einstellung).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `<velocimeter site="imu" …/>`                                                                              | Lokale **lineare Geschwindigkeit** am Site-Frame.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| `<framezaxis objtype="site" objname="imu" name="upvector"/>`                                               | Gibt die **z-Achse** des angegebenen Frames (hier: `imu`) im Weltbezug aus. Nützlich, um „oben/unten“ abzuleiten.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| `<framexaxis objtype="site" objname="imu" name="forwardvector"/>`                                          | Gibt die **x-Achse** des Frames (vorwärts-Richtung) im Weltbezug aus.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `<framelinvel objtype="site" objname="imu" name="global_linvel"/>`                                         | **Lineargeschwindigkeit** des Frames relativ zur Welt.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `<frameangvel objtype="site" objname="imu" name="global_angvel"/>`                                         | **Winkelgeschwindigkeit** des Frames relativ zur Welt.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `<framepos objtype="site" objname="imu" name="position"/>`                                                 | **Position** des Frames im Weltkoordinatensystem.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| `<framequat objtype="site" objname="imu" name="orientation"/>`                                             | **Orientierung** des Frames als Quaternion relativ zur Welt.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| `<framelinvel objtype="site" objname="l_foot"/"r_foot" …/>`                                                | Globale **Fußgeschwindigkeiten** (links/rechts). Für Gang-/Kontaktlogik wichtig.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| `<framexaxis objtype="site" objname="l_foot"/"r_foot" …/>`                                                 | Ausgelesene **Achsenrichtung** am Fuß (z. B. zur Schätzung von Fußkipplage).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| `<framepos objtype="site" objname="l_foot"/"r_foot" …/>`                                                   | **Fußpositionen** in Weltkoordinaten (Schritthöhe, Schrittweite, Standfuß-Erkennung).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |

---

## Kurzglossar der wichtigen Fachbegriffe

- **Radiant (rad)**: Winkeleinheit. \( \pi \,\text{rad} = 180^\circ \).
- **Integrator (Euler)**: Numerik, die aus Beschleunigungen/Geschwindigkeiten Positionen berechnet. Expliziter Euler ist einfach und schnell, aber weniger stabil als z. B. Runge-Kutta.
- **Dämpfung (joint damping)**: Viskose Reibung im Gelenk; Energie wird proportional zur Winkelgeschwindigkeit entzogen → stabilisiert.
- **Armature**: Zusatzträgheit am Gelenk (modeliert u. a. Motorgeometrie); glättet schnelle Drehbeschleunigungen.
- **Frictionloss**: Reibmoment, das überwunden werden muss (Coulomb/viskos gemischt).
- **`kp` (Positionsverstärkung)**: Steifigkeit des Positionsreglers. Hoch = folgt Sollwinkel hart/schnell; zu hoch → Schwingungen möglich.
- **`ctrlrange` / `forcerange`**: Erlaubter Eingangsbereich (Sollwert) bzw. maximale Aktuatorkraft/-moment.
- **Quaternion (`quat`)**: 4D-Darstellung einer Rotation (w, x, y, z). Robust gegen Gimbal-Lock; muss normiert sein.
- **Trägheitsmoment (`diaginertia`)**: Widerstand gegen Rotationsbeschleunigung um lokale Achsen.
- **Kollisionsmaske (`contype`, `conaffinity`)**: Steuern, welche Geometrien miteinander **Kontakt** erzeugen dürfen.
- **Site**: Markierter Referenz-/Messpunkt, den Sensoren/Kontroller verwenden.
- **Axis** (bei `joint`): Richtung der Rotationsachse eines 1-DoF-Gelenks.
- **Range** (bei `joint`): Mechanische Winkelbegrenzung (rad).
- **Ref** (bei `joint`): Referenzwinkelversatz für Sensorik/Regler.

---

## Benennung der Gelenke (Mapping)

- `*_HR` = **Hip Roll** (Torso/Becken seitlich kippen)  
- `*_HAA` = **Hip Ab-/Adduction** (Bein zur Seite/Zurück zur Mitte)  
- `*_HFE` = **Hip Flexion/Extension** (Bein vor/zurück)  
- `*_KFE` = **Knee Flexion/Extension** (Knie beugen/strecken)  
- `*_FFE` = **Foot Flexion/Extension** (Knöchel dors./plantar)  
- `*_FAA` = **Foot Ab-/Adduction** (Fuß medial/lateral kippen)  
- Präfix `LR_` = rechtes Bein („Leg Right“), `LL_` = linkes Bein („Leg Left“).

---

## Praxis-Hinweise

- **Reglerabstimmung**: Wenn die Simulation schwingt, `kp` reduzieren oder `damping`/`armature` leicht erhöhen.  
- **Schrittweite**: Für robustere Kontakte `timestep` kleiner wählen (z. B. 0.001), ggf. `iterations` erhöhen.  
- **Kollision vs. Visual**: Nutze einfache Kollisionskörper (`class="collision"`) und detaillierte Visuals getrennt – schneller und stabiler.
